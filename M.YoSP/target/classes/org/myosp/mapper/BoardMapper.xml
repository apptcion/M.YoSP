<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.myosp.mapper.BoardMapper">
	<resultMap type="org.myosp.domain.BoardDTO" id="boardDTO">
		<id property="board_id" column="board_id" />
		<result property="writer" column="writer"/>
		<result property="writeDate" column="writeDate"/>
		<result property="views" column="views"/>
		<result property="title" column="title"/>
		<result property="content" column="content"/>
		<result property="good" column="good"/>
		<result property="dislike" column="dislike"/>
		<result property="local" column="local"/>
		<result property="contentType" column="contentType"/>
		<result property="sources" column="sources"/>
	</resultMap>
	<select id="readAll" parameterType="Map" resultMap="boardDTO">
		<![CDATA[

				SELECT 
					/*+ INDEX_DESC(board pk_board)*/ * FROM board 
				WHERE 
					local like '%' ||  #{local} || '%'
				AND
					title like '%' || #{search} || '%'
				ORDER BY board_id desc
			
			
			]]>
	</select>
	
	<select id="readOne" parameterType="int" resultMap = "boardDTO">
		SELECT * FROM board where board_id = #{board_id}
	</select>
	
	<update id="addView" parameterType="org.myosp.domain.BoardDTO">
		update board set views=(#{views} + 1) where board_id = #{board_id}
	
	</update>
	
	
	<resultMap type="org.myosp.domain.AreaDTO" id="areaDTO">
		<id property="area_id" column="area_id" />
		<result property="koreanName" column="koreanName" />
		<result property="englishName" column="englishName" />
		<result property="address" column="address" />
		<result property="season" column="season" />
		<result property="popularity" column="popularity" />
		<result property="introduction" column="introduction" />
	</resultMap>
	
	<select id="getAreaList" resultMap="areaDTO">
	select * from areaList
	
	</select>
	
	<resultMap type="org.myosp.domain.LikeDTO" id="likeDTO">
		<id property="Board_id" column="board_id" />
		<result property="Member_id" column="member_id" />
	</resultMap>
	
	<select id="readLike" resultMap="likeDTO"> 
	select * from heart where board_id = #{board_id}	
	
	</select>
	
	
	<insert id="toGood" parameterType="Map">
		insert into heart (board_id,member_id) values (#{board_id}, #{member_id})
	</insert>
	
	
	<delete id="toBad" parameterType="Map">
		delete from heart where board_id = #{board_id} and member_id = #{member_id}
	</delete>
	
	<update id="UpCount" parameterType="int">
	update board set good = good +1 where board_id = #{board_id}
	</update>
	
	
	<update id="DownCount" parameterType="int">
	update board set good = good -1 where board_id = #{board_id}
	</update>
	
	
	<resultMap type="org.myosp.domain.CommentDTO" id="commentDTO">
		<id property="comment_id" column="comments_id" />
		<result property="board_id" column="board_id" /> 
		<result property="member_id" column="member_id" />
		<result property="userName" column="username" />
		<result property="writeDate" column="writedate" />
		<result property="content" column="comments" />
	</resultMap>
	
	<select id="readComments" parameterType="int" resultMap="commentDTO">
		
		select * from comments where board_id = #{board_id}
	
	</select>
	
	<insert id="enrolComment" parameterType="Map">
		insert into comments (Comments_id,board_id,member_id,username,comments) values (comments_seq.NEXTVAL,#{board_id},#{member_id},#{Username},#{Content})
	</insert>
	
	<update id="Cupdate">
		update comments set comments = #{Con } where comments_id = #{comment_id}
	</update>
	
	<delete id="Cdel">
		delete from comments where comments_id = #{comment_id}
	</delete>
	
</mapper>